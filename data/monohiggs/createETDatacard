#!/bin/sh
#preselection='pt_1>29&&pt_2>20&&vertices>0&&dilepton_veto==0&&iso04_1<0.15&&byTightIsolationMVArun2v1DBoldDMwLT_2>0.5&&tightElectrons<=1&&tightMuons==0&&againstElectronTightMVA6_2>0&&againstMuonLoose3_2>0&&njets<2&&nbtagNoSF==0'
#preselection='pt_1>29&&pt_2>20&&vertices>0&&dilepton_veto==0&&iso04_1<0.15&&tightElectrons<=1&&tightMuons==0&&againstElectronTightMVA6_2>0&&againstMuonLoose3_2>0&&nbtagNoSF==0&&(chargedIsoPtSum_2/pt_2)<0.02&&chargedIsoPtSum_2<0.5'
preselection='pt_1>29&&pt_2>20&&vertices>0&&dilepton_veto==0&&iso04_1<0.1&&tightElectrons<=1&&tightMuons==0&&againstElectronTightMVA6_2>0&&againstMuonLoose3_2>0&&(chargedIsoPtSum_2/pt_2)<0.02&&chargedIsoPtSum_2<0.5'
bselection='nbtag>=1'
antibselection='nbtag==0'
wselection='mt_1>0'
signalselection='pth>50&&met>100'
#signalselection='mt_2>130&&pth>75&&met>115'
qcdselection=$preselection
trigselection='pt_1>29' #only for MC
#trigselectiondata='pt_1>27&&HLT_Ele27_eta2p1_WPLoose_Gsf_v_fired>0&&lTrigger27>0'
trigselectiondata='pt_1>29&&((HLT_Ele25_eta2p1_WPTight_Gsf_v_fired>0&&lTrigger25>0)||(HLT_Ele27_eta2p1_WPLoose_Gsf_v_fired>0&&lTrigger27>0))&&nbtagNoSF==0'
#trigselectiondata='pt_1>27&&HLT_Ele25_eta2p1_WPTight_Gsf_v_fired>0'
relaxedSelection='pt_1>27&&pt_2>20&&vertices>0'
luminosity=12900. #pb
#luminosity=2246. #pb
direc='/nfs_scratch/laura/80X_charged_weighted/'
datadirec=$direc
zttScale=1.
qcdfactor=1.00
bTagSF='EffCSVWeight0'
topWeight='topWeight'
zWeight=1.0
bins=30
binning='binningHighStat=0.,10.,20.,30.,40.,50.,60.,70.,80.,90.,100.,110.,120.,130.,140.,150.,160.,170.,180.,190.,200.,225.,250.,275.,300.,325.,350. binningLowStat=0.,20.,40.,60.,80.,100.,120.,140.,160.,180.,200.,250.,300.,350.' 
mkdir datacards

#m_vis&
nohup MakeDataCardXTT channel='eleTau'  dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='m_vis' bins=200 min=0 max=2000 outputFile='datacards/et_m_vis.root' & 
nohup MakeDataCardXTT channel='eleTau' dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection='mt_1>0'  qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='mt_1' bins=200 min=0 max=2000 outputFile='datacards/et_mt_1.root' &
nohup MakeDataCardXTT channel='eleTau' dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection  qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='mt_2' bins=200 min=0 max=2000 outputFile='datacards/et_mt_2.root' &
nohup MakeDataCardXTT channel='eleTau' dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection  qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='mt12' bins=200 min=0 max=2000 outputFile='datacards/et_mt.root' &
#met&
nohup MakeDataCardXTT channel='eleTau' dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='met' bins=200 min=0 max=2000 outputFile='datacards/et_met.root' &
nohup MakeDataCardXTT channel='eleTau' dataFile=$datadirec'eleDATA129.root' qcdFile=$direc'eleDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' inclselection=$inclselection preselection=$preselection  wselection=$wselection relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*myisoweight_1*mytrigweight_1'  luminosity=$luminosity  variable='pth' bins=200 min=0 max=2000 outputFile='datacards/et_pt.root' &
exit;
