#!/bin/sh
preselection='pt_1>25&&pt_2>20&&npv>0&&diLeptons==0&&iso04_1<0.15&&(chargedIsoPtSum_2/pt_2)<0.02&&tightMuons<=1&&tightElectrons==0&&againstMuonTight3_2>0&&againstElectronVLooseMVA6_2>0&&chargedIsoPtSum_2<0.5'
#preselection='pt_1>25&&pt_2>20&&npv>0&&diLeptons==0&&iso04_1<0.15&&(chargedIsoPtSum_2/pt_2)<0.02&&tightMuons<=1&&tightElectrons==0&&againstMuonTight3_2>0&&againstElectronVLooseMVA6_2>0&&nbtagNoSF==0&&chargedIsoPtSum_2<0.5'
#preselection='pt_1>25&&pt_2>20&&npv>0&&diLeptons==0&&iso04_1<0.1&&byTightIsolationMVArun2v1DBoldDMwLT_2>0.5&&tightMuons<=1&&tightElectrons==0&&againstMuonTight3_2>0&&againstElectronVLooseMVA6_2>0&&diLeptons==0&&nbtagNoSF==0&&njets<2'
wselection='mt_1>0'
#signalselection='mt_1>0'
signalselection='pth>50&&met>100'
qcdselection=$inclselection
trigselection='pt_1>25' #only for MC
#trigselectiondata='pt_1>24&&HLT_Any' #only for Data
#trigselectiondata='pt_1>24' #only for Data
#trigselectiondata='run>274093&&pt_1>24&&HLT_IsoMu22_v_fired>0' #only for Data
trigselectiondata='nbtagNoSF==0&&pt_1>25&&(HLT_IsoMu22_v_fired>0||HLT_IsoTkMu22_v_fired>0)' #only for Data
#trigselectiondata='run>274093&&pt_1>21' #only for Data
#trigselectiondata='run>274093&&pt_1>21&&HLT_IsoMu19_eta2p1_LooseIsoPFTau20_v_fired>0' #only for Data
#trigselectiondata='run>274093&&pt_1>21&&(HLT_IsoMu19_eta2p1_LooseIsoPFTau20_SingleL1_v_fired>0||HLT_IsoMu19_eta2p1_LooseIsoPFTau20_v_fired>0)' #only for Data
relaxedSelection='pt_1>25&&pt_2>40&&npv>0&&diLeptons==0&&iso04_1<0.15&&tauIsoMedium>0.5'
#luminosity= 1470 #pb
luminosity=12900 #pb
#luminosity=2246. #pb
direc='/nfs_scratch/laura/80X_charged_weighted/'
datadirec='/nfs_scratch/laura/80X_charged_weighted/'
zttScale=1.
topWeight='topWeight'
bTagSF='EffCSVWeight0Up'
zWeight=1.0
qcdfactor=1.0
bins=30

binning='binningLowStat=20.,30.,40.,45.,50.,55.,60.,65.,70.,75.,80.,85.,90.,95.,100.,110.,120.,130.,150. binningHighStat=0.,20.,40.,60.,80.,100.,120.,140.,160.,180.,200.,250.,300.,350.' 
mkdir datacards

#m_vis Madgraph
MakeDataCardXTT channel='muTau'  dataFile=$datadirec'muDATA129.root' qcdFile=$direc'muDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' preselection=$preselection  wselection=$wselection  relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*POGid1*POGid2*POGtrigger*POGtrack'  luminosity=$luminosity  variable='m_vis' bins=200 min=0 max=2000 outputFile='datacards/mt_m_vis.root'  
#mt12 &
nohup MakeDataCardXTT channel='muTau' dataFile=$datadirec'muDATA129.root' qcdFile=$direc'muDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' preselection=$preselection  wselection=$wselection  relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*POGid1*POGid2*POGtrigger*POGtrack'  luminosity=$luminosity  variable='mt12' bins=200 min=0 max=2000 outputFile='datacards/mt_mt.root'  &
nohup MakeDataCardXTT channel='muTau' dataFile=$datadirec'muDATA129.root' qcdFile=$direc'muDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' preselection=$preselection  wselection=$wselection  relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*POGid1*POGid2*POGtrigger*POGtrack'  luminosity=$luminosity  variable='pth' bins=200 min=0 max=2000 outputFile='datacards/mt_pt.root'  &
nohup MakeDataCardXTT channel='muTau' dataFile=$datadirec'muDATA129.root' qcdFile=$direc'muDATA129.root' zttFile=$direc'ZJETS.root' zllFile=$direc'ZJETS.root' wFile=$direc'WJETSHT.root' vvFile=$direc'DiBoson.root' zvvFile=$direc'Znunu.root' topFile=$direc'TT.root' preselection=$preselection  wselection=$wselection  relaxedSelection=$relaxedSelection trigselection=$trigselection trigselection50ns=$trigselectiondata  signalselection=$signalselection   qcdselection=$qcdselection luminosityErr=0.045 qcdfactor=$qcdfactor qcdfactorErr=0.02 vvErr=0.3   zttScale=$zttScale zttScaleErr=0.033    wFactorErr=0.06    zjfterr=0.1  zlfterr=0.24   topErr=0.075  bTagSF=$bTagSF 	muID=1.00 muIDErr=0.01 eleID=0.0 eleIDErr=0.0 tauID=1.0 tauIDErr=0.06  dir=$direc''  bID=1.0  bIDErr=0.10  bMisID=1.0  bMisIDErr=0.17    bitmask=1,0,0,0 TTweight=$topWeight Zweight=$zWeight weight='__WEIGHT__*GENWEIGHT*puweight*POGid1*POGid2*POGtrigger*POGtrack'  luminosity=$luminosity  variable='met' bins=200 min=0 max=2000 outputFile='datacards/mt_met.root'  &
exit;
